{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/Users/shai/9april2021/components/conf-entry.tsx\";\n\n/**\n * Copyright 2020 Vercel Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport cn from 'classnames';\nimport { useCallback, useState } from 'react';\nimport styleUtils from './utils.module.css';\nimport styles from './conf-entry.module.css';\nimport LoadingDots from './loading-dots';\nimport { register } from '@lib/user-api';\nimport { SITE_DESCRIPTION } from '@lib/constants';\nimport useEmailQueryParam from '@lib/hooks/use-email-query-param';\nconst DEFAULT_ERROR_MSG = 'Error! Please try again.';\n\nfunction getErrorMsg(code) {\n  switch (code) {\n    case 'bad_email':\n      return 'Please enter a valid email';\n\n    default:\n      return DEFAULT_ERROR_MSG;\n  }\n}\n\nexport default function ConfEntry({\n  onRegister\n}) {\n  const {\n    0: emailInput,\n    1: setEmailInput\n  } = useState('');\n  const {\n    0: focused,\n    1: setFocused\n  } = useState(false);\n  const {\n    0: formState,\n    1: setFormState\n  } = useState('default');\n  const {\n    0: errorMsg,\n    1: setErrorMsg\n  } = useState('');\n  const onSubmit = useCallback(async e => {\n    try {\n      e.preventDefault();\n      setFormState('loading');\n      const res = await register(emailInput);\n\n      if (!res.ok) {\n        const json = await res.json();\n        setErrorMsg(getErrorMsg(json.error.code));\n        setFormState('error');\n        return;\n      }\n\n      onRegister();\n    } catch (err) {\n      console.error(err);\n      setErrorMsg(DEFAULT_ERROR_MSG);\n      setFormState('error');\n    }\n  }, [emailInput, onRegister]);\n  useEmailQueryParam('login', setEmailInput);\n  const onTryAgainClick = useCallback(e => {\n    e.preventDefault();\n    setErrorMsg('');\n    setFormState('default');\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: cn(styles.container, styleUtils.appear, styleUtils['appear-first']),\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: cn(styles.hero),\n      children: \"Join the conference.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      className: cn(styles.description),\n      children: SITE_DESCRIPTION\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: onSubmit,\n      className: styles.form,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles['form-row'],\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"email-input-field\",\n          className: cn(styles['input-label'], {\n            [styles.focused]: focused,\n            [styles.error]: formState === 'error'\n          }),\n          children: formState === 'error' ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: cn(styles.input, styles['input-text']),\n            children: errorMsg\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"input\", {\n            className: styles.input,\n            autoComplete: \"off\",\n            type: \"email\",\n            id: \"email-input-field\",\n            value: emailInput,\n            onChange: e => setEmailInput(e.target.value),\n            onFocus: () => setFocused(true),\n            onBlur: () => setFocused(false),\n            placeholder: \"Enter email to join the event\",\n            \"aria-label\": \"Your email address\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: cn(styles.submit, styles.register, styles[formState]),\n          disabled: formState === 'loading',\n          onClick: formState === 'error' ? onTryAgainClick : undefined,\n          children: formState === 'loading' ? /*#__PURE__*/_jsxDEV(LoadingDots, {\n            size: 4\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: formState === 'error' ? 'Try Again' : 'Join'\n          }, void 0, false)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 5\n  }, this);\n}","map":{"version":3,"sources":["/Users/shai/9april2021/components/conf-entry.tsx"],"names":["cn","useCallback","useState","styleUtils","styles","LoadingDots","register","SITE_DESCRIPTION","useEmailQueryParam","DEFAULT_ERROR_MSG","getErrorMsg","code","ConfEntry","onRegister","emailInput","setEmailInput","focused","setFocused","formState","setFormState","errorMsg","setErrorMsg","onSubmit","e","preventDefault","res","ok","json","error","err","console","onTryAgainClick","container","appear","hero","description","form","input","target","value","submit","undefined"],"mappings":"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","sourcesContent":["/**\n * Copyright 2020 Vercel Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport cn from 'classnames';\nimport { useCallback, useState } from 'react';\nimport styleUtils from './utils.module.css';\nimport styles from './conf-entry.module.css';\nimport LoadingDots from './loading-dots';\nimport { register } from '@lib/user-api';\nimport { SITE_DESCRIPTION } from '@lib/constants';\nimport useEmailQueryParam from '@lib/hooks/use-email-query-param';\n\ntype FormState = 'default' | 'loading' | 'error';\n\nconst DEFAULT_ERROR_MSG = 'Error! Please try again.';\n\nfunction getErrorMsg(code: string) {\n  switch (code) {\n    case 'bad_email':\n      return 'Please enter a valid email';\n    default:\n      return DEFAULT_ERROR_MSG;\n  }\n}\n\nexport default function ConfEntry({ onRegister }: { onRegister: () => void }) {\n  const [emailInput, setEmailInput] = useState('');\n  const [focused, setFocused] = useState(false);\n  const [formState, setFormState] = useState<FormState>('default');\n  const [errorMsg, setErrorMsg] = useState('');\n\n  const onSubmit = useCallback(\n    async e => {\n      try {\n        e.preventDefault();\n        setFormState('loading');\n\n        const res = await register(emailInput);\n\n        if (!res.ok) {\n          const json = await res.json();\n          setErrorMsg(getErrorMsg(json.error.code));\n          setFormState('error');\n          return;\n        }\n\n        onRegister();\n      } catch (err) {\n        console.error(err);\n        setErrorMsg(DEFAULT_ERROR_MSG);\n        setFormState('error');\n      }\n    },\n    [emailInput, onRegister]\n  );\n\n  useEmailQueryParam('login', setEmailInput);\n\n  const onTryAgainClick = useCallback(e => {\n    e.preventDefault();\n    setErrorMsg('');\n    setFormState('default');\n  }, []);\n\n  return (\n    <div className={cn(styles.container, styleUtils.appear, styleUtils['appear-first'])}>\n      <h1 className={cn(styles.hero)}>Join the conference.</h1>\n      <h2 className={cn(styles.description)}>{SITE_DESCRIPTION}</h2>\n      <form onSubmit={onSubmit} className={styles.form}>\n        <div className={styles['form-row']}>\n          <label\n            htmlFor=\"email-input-field\"\n            className={cn(styles['input-label'], {\n              [styles.focused]: focused,\n              [styles.error]: formState === 'error'\n            })}\n          >\n            {formState === 'error' ? (\n              <div className={cn(styles.input, styles['input-text'])}>{errorMsg}</div>\n            ) : (\n              <input\n                className={styles.input}\n                autoComplete=\"off\"\n                type=\"email\"\n                id=\"email-input-field\"\n                value={emailInput}\n                onChange={e => setEmailInput(e.target.value)}\n                onFocus={() => setFocused(true)}\n                onBlur={() => setFocused(false)}\n                placeholder=\"Enter email to join the event\"\n                aria-label=\"Your email address\"\n                required\n              />\n            )}\n          </label>\n          <button\n            type=\"submit\"\n            className={cn(styles.submit, styles.register, styles[formState])}\n            disabled={formState === 'loading'}\n            onClick={formState === 'error' ? onTryAgainClick : undefined}\n          >\n            {formState === 'loading' ? (\n              <LoadingDots size={4} />\n            ) : (\n              <>{formState === 'error' ? 'Try Again' : 'Join'}</>\n            )}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}
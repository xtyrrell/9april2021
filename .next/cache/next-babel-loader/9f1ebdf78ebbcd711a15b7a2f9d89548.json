{"ast":null,"code":"import _defineProperty from \"/Users/shai/9april2021/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/shai/9april2021/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/shai/9april2021/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/shai/9april2021/components/conf-entry.tsx\",\n    _s = $RefreshSig$();\n\n/**\n * Copyright 2020 Vercel Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport cn from 'classnames';\nimport { useCallback, useState } from 'react';\nimport styleUtils from './utils.module.css';\nimport styles from './conf-entry.module.css';\nimport LoadingDots from './loading-dots';\nimport { register } from '@lib/user-api';\nimport { SITE_DESCRIPTION } from '@lib/constants';\nimport useEmailQueryParam from '@lib/hooks/use-email-query-param';\nvar DEFAULT_ERROR_MSG = 'Error! Please try again.';\n\nfunction getErrorMsg(code) {\n  switch (code) {\n    case 'bad_email':\n      return 'Please enter a valid email';\n\n    default:\n      return DEFAULT_ERROR_MSG;\n  }\n}\n\nexport default function ConfEntry(_ref) {\n  _s();\n\n  var _cn;\n\n  var onRegister = _ref.onRegister;\n\n  var _useState = useState(''),\n      emailInput = _useState[0],\n      setEmailInput = _useState[1];\n\n  var _useState2 = useState(false),\n      focused = _useState2[0],\n      setFocused = _useState2[1];\n\n  var _useState3 = useState('default'),\n      formState = _useState3[0],\n      setFormState = _useState3[1];\n\n  var _useState4 = useState(''),\n      errorMsg = _useState4[0],\n      setErrorMsg = _useState4[1];\n\n  var onSubmit = useCallback( /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(e) {\n      var res, json;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              e.preventDefault();\n              setFormState('loading');\n              _context.next = 5;\n              return register(emailInput);\n\n            case 5:\n              res = _context.sent;\n\n              if (res.ok) {\n                _context.next = 13;\n                break;\n              }\n\n              _context.next = 9;\n              return res.json();\n\n            case 9:\n              json = _context.sent;\n              setErrorMsg(getErrorMsg(json.error.code));\n              setFormState('error');\n              return _context.abrupt(\"return\");\n\n            case 13:\n              onRegister();\n              _context.next = 21;\n              break;\n\n            case 16:\n              _context.prev = 16;\n              _context.t0 = _context[\"catch\"](0);\n              console.error(_context.t0);\n              setErrorMsg(DEFAULT_ERROR_MSG);\n              setFormState('error');\n\n            case 21:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 16]]);\n    }));\n\n    return function (_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(), [emailInput, onRegister]);\n  useEmailQueryParam('login', setEmailInput);\n  var onTryAgainClick = useCallback(function (e) {\n    e.preventDefault();\n    setErrorMsg('');\n    setFormState('default');\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: cn(styles.container, styleUtils.appear, styleUtils['appear-first']),\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: cn(styles.hero),\n      children: \"Join the conference.\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      className: cn(styles.description),\n      children: SITE_DESCRIPTION\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: onSubmit,\n      className: styles.form,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles['form-row'],\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"email-input-field\",\n          className: cn(styles['input-label'], (_cn = {}, _defineProperty(_cn, styles.focused, focused), _defineProperty(_cn, styles.error, formState === 'error'), _cn)),\n          children: formState === 'error' ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: cn(styles.input, styles['input-text']),\n            children: errorMsg\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(\"input\", {\n            className: styles.input,\n            autoComplete: \"off\",\n            type: \"email\",\n            id: \"email-input-field\",\n            value: emailInput,\n            onChange: function onChange(e) {\n              return setEmailInput(e.target.value);\n            },\n            onFocus: function onFocus() {\n              return setFocused(true);\n            },\n            onBlur: function onBlur() {\n              return setFocused(false);\n            },\n            placeholder: \"Enter email to join the event\",\n            \"aria-label\": \"Your email address\",\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: cn(styles.submit, styles.register, styles[formState]),\n          disabled: formState === 'loading',\n          onClick: formState === 'error' ? onTryAgainClick : undefined,\n          children: formState === 'loading' ? /*#__PURE__*/_jsxDEV(LoadingDots, {\n            size: 4\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 15\n          }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n            children: formState === 'error' ? 'Try Again' : 'Join'\n          }, void 0, false)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 79,\n    columnNumber: 5\n  }, this);\n}\n\n_s(ConfEntry, \"e7p50XtdTJR4jlk5a2sKBUb6vwA=\", false, function () {\n  return [useEmailQueryParam];\n});\n\n_c = ConfEntry;\n\nvar _c;\n\n$RefreshReg$(_c, \"ConfEntry\");","map":{"version":3,"sources":["/Users/shai/9april2021/components/conf-entry.tsx"],"names":["cn","useCallback","useState","styleUtils","styles","LoadingDots","register","SITE_DESCRIPTION","useEmailQueryParam","DEFAULT_ERROR_MSG","getErrorMsg","code","ConfEntry","onRegister","emailInput","setEmailInput","focused","setFocused","formState","setFormState","errorMsg","setErrorMsg","onSubmit","e","preventDefault","res","ok","json","error","console","onTryAgainClick","container","appear","hero","description","form","input","target","value","submit","undefined"],"mappings":"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","sourcesContent":["/**\n * Copyright 2020 Vercel Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport cn from 'classnames';\nimport { useCallback, useState } from 'react';\nimport styleUtils from './utils.module.css';\nimport styles from './conf-entry.module.css';\nimport LoadingDots from './loading-dots';\nimport { register } from '@lib/user-api';\nimport { SITE_DESCRIPTION } from '@lib/constants';\nimport useEmailQueryParam from '@lib/hooks/use-email-query-param';\n\ntype FormState = 'default' | 'loading' | 'error';\n\nconst DEFAULT_ERROR_MSG = 'Error! Please try again.';\n\nfunction getErrorMsg(code: string) {\n  switch (code) {\n    case 'bad_email':\n      return 'Please enter a valid email';\n    default:\n      return DEFAULT_ERROR_MSG;\n  }\n}\n\nexport default function ConfEntry({ onRegister }: { onRegister: () => void }) {\n  const [emailInput, setEmailInput] = useState('');\n  const [focused, setFocused] = useState(false);\n  const [formState, setFormState] = useState<FormState>('default');\n  const [errorMsg, setErrorMsg] = useState('');\n\n  const onSubmit = useCallback(\n    async e => {\n      try {\n        e.preventDefault();\n        setFormState('loading');\n\n        const res = await register(emailInput);\n\n        if (!res.ok) {\n          const json = await res.json();\n          setErrorMsg(getErrorMsg(json.error.code));\n          setFormState('error');\n          return;\n        }\n\n        onRegister();\n      } catch (err) {\n        console.error(err);\n        setErrorMsg(DEFAULT_ERROR_MSG);\n        setFormState('error');\n      }\n    },\n    [emailInput, onRegister]\n  );\n\n  useEmailQueryParam('login', setEmailInput);\n\n  const onTryAgainClick = useCallback(e => {\n    e.preventDefault();\n    setErrorMsg('');\n    setFormState('default');\n  }, []);\n\n  return (\n    <div className={cn(styles.container, styleUtils.appear, styleUtils['appear-first'])}>\n      <h1 className={cn(styles.hero)}>Join the conference.</h1>\n      <h2 className={cn(styles.description)}>{SITE_DESCRIPTION}</h2>\n      <form onSubmit={onSubmit} className={styles.form}>\n        <div className={styles['form-row']}>\n          <label\n            htmlFor=\"email-input-field\"\n            className={cn(styles['input-label'], {\n              [styles.focused]: focused,\n              [styles.error]: formState === 'error'\n            })}\n          >\n            {formState === 'error' ? (\n              <div className={cn(styles.input, styles['input-text'])}>{errorMsg}</div>\n            ) : (\n              <input\n                className={styles.input}\n                autoComplete=\"off\"\n                type=\"email\"\n                id=\"email-input-field\"\n                value={emailInput}\n                onChange={e => setEmailInput(e.target.value)}\n                onFocus={() => setFocused(true)}\n                onBlur={() => setFocused(false)}\n                placeholder=\"Enter email to join the event\"\n                aria-label=\"Your email address\"\n                required\n              />\n            )}\n          </label>\n          <button\n            type=\"submit\"\n            className={cn(styles.submit, styles.register, styles[formState])}\n            disabled={formState === 'loading'}\n            onClick={formState === 'error' ? onTryAgainClick : undefined}\n          >\n            {formState === 'loading' ? (\n              <LoadingDots size={4} />\n            ) : (\n              <>{formState === 'error' ? 'Try Again' : 'Join'}</>\n            )}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}